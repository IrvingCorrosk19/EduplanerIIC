@model SchoolManager.Dtos.PaymentDto
@{
    Layout = "_AdminLayout";
    ViewData["Title"] = "Detalles de Pago";
}

<div class="container-fluid">
    <div class="row mb-4">
        <div class="col-12">
            <div class="portal-header">
                <h3><i class="fas fa-money-check-alt mr-2"></i>Detalles de Pago</h3>
                <small>Información completa del pago registrado</small>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-md-8 offset-md-2">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0"><i class="fas fa-file-invoice mr-2"></i>Información del Pago</h5>
                </div>
                <div class="card-body">
                    <dl class="row">
                        <dt class="col-sm-4">Número de Recibo:</dt>
                        <dd class="col-sm-8"><code>@Model.ReceiptNumber</code></dd>

                        @if (!string.IsNullOrEmpty(Model.PaymentConceptName))
                        {
                            <dt class="col-sm-4">Concepto de Pago:</dt>
                            <dd class="col-sm-8"><strong>@Model.PaymentConceptName</strong></dd>
                        }

                        <dt class="col-sm-4">Monto:</dt>
                        <dd class="col-sm-8"><strong>@Model.Amount.ToString("C")</strong></dd>

                        @if (!string.IsNullOrEmpty(Model.PaymentMethod))
                        {
                            <dt class="col-sm-4">Método de Pago:</dt>
                            <dd class="col-sm-8"><span class="badge bg-info">@Model.PaymentMethod</span></dd>
                        }

                        <dt class="col-sm-4">Fecha de Pago:</dt>
                        <dd class="col-sm-8">@TimeZoneService.ToLocalDisplayString(Model.PaymentDate, "dd/MM/yyyy HH:mm")</dd>

                        <dt class="col-sm-4">Estado:</dt>
                        <dd class="col-sm-8">
                            @if (Model.PaymentStatus == "Confirmado")
                            {
                                <span class="badge bg-success">Confirmado</span>
                            }
                            else
                            {
                                <span class="badge bg-warning">Pendiente</span>
                            }
                        </dd>

                        @if (!string.IsNullOrEmpty(Model.StudentName))
                        {
                            <dt class="col-sm-4">Estudiante:</dt>
                            <dd class="col-sm-8">@Model.StudentName</dd>
                        }

                        @if (!string.IsNullOrEmpty(Model.RegisteredByName))
                        {
                            <dt class="col-sm-4">Registrado Por:</dt>
                            <dd class="col-sm-8">@Model.RegisteredByName</dd>
                        }

                        <dt class="col-sm-4">Fecha de Registro:</dt>
                        <dd class="col-sm-8">@TimeZoneService.ToLocalDisplayString(Model.CreatedAt, "dd/MM/yyyy HH:mm")</dd>

                        @if (Model.ConfirmedAt.HasValue)
                        {
                            <dt class="col-sm-4">Fecha de Confirmación:</dt>
                            <dd class="col-sm-8">@TimeZoneService.ToLocalDisplayString(Model.ConfirmedAt, "dd/MM/yyyy HH:mm")</dd>
                        }

                        @if (!string.IsNullOrEmpty(Model.ReceiptImage))
                        {
                            <dt class="col-sm-4">Comprobante de Pago:</dt>
                            <dd class="col-sm-8">
                                <a href="@Model.ReceiptImage" target="_blank" class="btn btn-sm btn-primary">
                                    <i class="fas fa-image mr-2"></i>Ver Comprobante
                                </a>
                            </dd>
                        }

                        @if (!string.IsNullOrEmpty(Model.Notes))
                        {
                            <dt class="col-sm-4">Notas:</dt>
                            <dd class="col-sm-8">@Model.Notes</dd>
                        }
                    </dl>

                    <div class="mt-4">
                        <a href="@Url.Action("Index")" class="btn btn-secondary">
                            <i class="fas fa-arrow-left mr-2"></i>Volver
                        </a>
                        @if (Model.PaymentStatus != "Confirmado")
                        {
                            <form method="post" action="@Url.Action("Confirm", new { id = Model.Id })" style="display:inline;" onsubmit="return confirm('¿Confirma este pago?');">
                                <button type="submit" class="btn btn-success">
                                    <i class="fas fa-check mr-2"></i>Confirmar Pago
                                </button>
                            </form>
                        }
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

